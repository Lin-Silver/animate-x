[2025-03-22 00:45:41,447] INFO: {'__name__': 'Config: VideoLDM Decoder', 'mean': [0.5, 0.5, 0.5], 'std': [0.5, 0.5, 0.5], 'max_words': 1000, 'num_workers': 8, 'prefetch_factor': 2, 'resolution': [512, 768], 'vit_out_dim': 1024, 'vit_resolution': [224, 224], 'depth_clamp': 10.0, 'misc_size': 384, 'depth_std': 20.0, 'save_fps': 8, 'frame_lens': [32, 32, 32, 1], 'sample_fps': [4], 'vid_dataset': {'type': 'VideoBaseDataset', 'data_list': [], 'max_words': 1000, 'resolution': [448, 256]}, 'img_dataset': {'type': 'ImageBaseDataset', 'data_list': ['laion_400m'], 'max_words': 1000, 'resolution': [448, 256]}, 'batch_sizes': {'1': 256, '4': 4, '8': 4, '16': 4}, 'Diffusion': {'type': 'DiffusionDDIM', 'schedule': 'linear_sd', 'schedule_param': {'num_timesteps': 1000, 'init_beta': 0.00085, 'last_beta': 0.012, 'zero_terminal_snr': True}, 'mean_type': 'v', 'loss_type': 'mse', 'var_type': 'fixed_small', 'rescale_timesteps': False, 'noise_strength': 0.1, 'ddim_timesteps': 50}, 'ddim_timesteps': 30, 'use_div_loss': False, 'p_zero': 0.9, 'guide_scale': 2.5, 'vit_mean': [0.48145466, 0.4578275, 0.40821073], 'vit_std': [0.26862954, 0.26130258, 0.27577711], 'sketch_mean': [0.485, 0.456, 0.406], 'sketch_std': [0.229, 0.224, 0.225], 'hist_sigma': 10.0, 'scale_factor': 0.18215, 'use_checkpoint': True, 'use_sharded_ddp': False, 'use_fsdp': False, 'use_fp16': True, 'temporal_attention': True, 'UNet': {'type': 'UNetSD_Animate_X', 'in_dim': 4, 'dim': 320, 'y_dim': 1024, 'context_dim': 1024, 'out_dim': 4, 'dim_mult': [1, 2, 4, 4], 'num_heads': 8, 'head_dim': 64, 'num_res_blocks': 2, 'attn_scales': [1.0, 0.5, 0.25], 'dropout': 0.1, 'temporal_attention': True, 'temporal_attn_times': 1, 'use_checkpoint': True, 'use_fps_condition': False, 'use_sim_mask': False, 'config': 'None', 'num': 0, 'no_hand': True, 'num_tokens': 4}, 'guidances': [], 'auto_encoder': {'type': 'AutoencoderKL', 'ddconfig': {'double_z': True, 'z_channels': 4, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 4, 4], 'num_res_blocks': 2, 'attn_resolutions': [], 'dropout': 0.0, 'video_kernel_size': [3, 1, 1]}, 'embed_dim': 4, 'pretrained': 'checkpoints/v2-1_512-ema-pruned.ckpt'}, 'embedder': {'type': 'FrozenOpenCLIPTextVisualEmbedder', 'layer': 'penultimate', 'pretrained': 'checkpoints/open_clip_pytorch_model.bin'}, 'ema_decay': 0.9999, 'num_steps': 600000, 'lr': 5e-05, 'weight_decay': 0.0, 'betas': (0.9, 0.999), 'eps': 1e-08, 'chunk_size': 2, 'decoder_bs': 2, 'alpha': 0.7, 'save_ckp_interval': 1000, 'warmup_steps': 10, 'decay_mode': 'cosine', 'use_ema': False, 'load_from': None, 'Pretrain': {'type': 'pretrain_specific_strategies', 'fix_weight': False, 'grad_scale': 0.2, 'resume_checkpoint': 'models/jiuniu_0267000.pth', 'sd_keys_path': 'models/stable_diffusion_image_key_temporal_attention_x1.json'}, 'viz_interval': 1000, 'resume_checkpoint': '', 'visual_train': {'type': 'VisualTrainTextImageToVideo'}, 'visual_inference': {'type': 'VisualGeneratedVideos'}, 'inference_list_path': '', 'log_interval': 100, 'log_dir': 'results\\Animate_X_infer', 'seed': 13, 'negative_prompt': 'Distorted, discontinuous, Ugly, blurry, low resolution, motionless, static, disfigured, disconnected limbs, Ugly faces, incomplete arms', 'max_frames': 132, 'round': 5, 'test_list_path': [[2, 'data/images/1.jpg', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/4.png', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/3.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 13], [2, 'data/images/10.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 14], [2, 'data/images/zhu.png', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [2, 'data/images/5.jpeg', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [1, 'data/images/2.jpeg', 'data/saved_pose/dance_3_right', 'data/saved_frames/dance_3_right', 'data/saved_pkl/dance_3_right.pkl', 13], [4, 'data/images/7.jpeg', 'data/saved_pose/ubc', 'data/saved_frames/ubc', 'data/saved_pkl/ubc.pkl', 14]], 'test_model': 'checkpoints/animate-x_ckpt.pth', 'partial_keys': [['image', 'local_image', 'dwpose', 'pose_embeddings']], 'TASK_TYPE': 'inference_animate_x_entrance', 'batch_size': 1, 'latent_random_ref': True, 'scale': 8, 'use_fps_condition': False, 'video_compositions': ['image', 'local_image', 'dwpose', 'randomref', 'randomref_pose', 'pose_embedding'], 'use_DiffusionDPM': False, 'CPU_CLIP_VAE': True, 'cfg_file': 'configs/Animate_X_infer.yaml', 'init_method': 'tcp://localhost:9999', 'debug': False, 'opts': [], 'pmi_rank': 0, 'pmi_world_size': 1, 'gpus_per_machine': 1, 'world_size': 1, 'gpu': 0, 'rank': 0, 'log_file': 'results\\Animate_X_infer\\log_00.txt'}
[2025-03-22 00:45:41,447] INFO: Running Animate-X inference on gpu 0
[2025-03-22 00:45:41,455] INFO: Loaded ViT-H-14 model config.
[2025-03-22 00:45:46,958] INFO: Loading pretrained ViT-H-14 weights (checkpoints/open_clip_pytorch_model.bin).
[2025-03-22 00:55:16,497] INFO: {'__name__': 'Config: VideoLDM Decoder', 'mean': [0.5, 0.5, 0.5], 'std': [0.5, 0.5, 0.5], 'max_words': 1000, 'num_workers': 8, 'prefetch_factor': 2, 'resolution': [512, 768], 'vit_out_dim': 1024, 'vit_resolution': [224, 224], 'depth_clamp': 10.0, 'misc_size': 384, 'depth_std': 20.0, 'save_fps': 8, 'frame_lens': [32, 32, 32, 1], 'sample_fps': [4], 'vid_dataset': {'type': 'VideoBaseDataset', 'data_list': [], 'max_words': 1000, 'resolution': [448, 256]}, 'img_dataset': {'type': 'ImageBaseDataset', 'data_list': ['laion_400m'], 'max_words': 1000, 'resolution': [448, 256]}, 'batch_sizes': {'1': 256, '4': 4, '8': 4, '16': 4}, 'Diffusion': {'type': 'DiffusionDDIM', 'schedule': 'linear_sd', 'schedule_param': {'num_timesteps': 1000, 'init_beta': 0.00085, 'last_beta': 0.012, 'zero_terminal_snr': True}, 'mean_type': 'v', 'loss_type': 'mse', 'var_type': 'fixed_small', 'rescale_timesteps': False, 'noise_strength': 0.1, 'ddim_timesteps': 50}, 'ddim_timesteps': 30, 'use_div_loss': False, 'p_zero': 0.9, 'guide_scale': 2.5, 'vit_mean': [0.48145466, 0.4578275, 0.40821073], 'vit_std': [0.26862954, 0.26130258, 0.27577711], 'sketch_mean': [0.485, 0.456, 0.406], 'sketch_std': [0.229, 0.224, 0.225], 'hist_sigma': 10.0, 'scale_factor': 0.18215, 'use_checkpoint': True, 'use_sharded_ddp': False, 'use_fsdp': False, 'use_fp16': True, 'temporal_attention': True, 'UNet': {'type': 'UNetSD_Animate_X', 'in_dim': 4, 'dim': 320, 'y_dim': 1024, 'context_dim': 1024, 'out_dim': 4, 'dim_mult': [1, 2, 4, 4], 'num_heads': 8, 'head_dim': 64, 'num_res_blocks': 2, 'attn_scales': [1.0, 0.5, 0.25], 'dropout': 0.1, 'temporal_attention': True, 'temporal_attn_times': 1, 'use_checkpoint': True, 'use_fps_condition': False, 'use_sim_mask': False, 'config': 'None', 'num': 0, 'no_hand': True, 'num_tokens': 4}, 'guidances': [], 'auto_encoder': {'type': 'AutoencoderKL', 'ddconfig': {'double_z': True, 'z_channels': 4, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 4, 4], 'num_res_blocks': 2, 'attn_resolutions': [], 'dropout': 0.0, 'video_kernel_size': [3, 1, 1]}, 'embed_dim': 4, 'pretrained': 'checkpoints/v2-1_512-ema-pruned.ckpt'}, 'embedder': {'type': 'FrozenOpenCLIPTextVisualEmbedder', 'layer': 'penultimate', 'pretrained': 'checkpoints/open_clip_pytorch_model.bin'}, 'ema_decay': 0.9999, 'num_steps': 600000, 'lr': 5e-05, 'weight_decay': 0.0, 'betas': (0.9, 0.999), 'eps': 1e-08, 'chunk_size': 2, 'decoder_bs': 2, 'alpha': 0.7, 'save_ckp_interval': 1000, 'warmup_steps': 10, 'decay_mode': 'cosine', 'use_ema': False, 'load_from': None, 'Pretrain': {'type': 'pretrain_specific_strategies', 'fix_weight': False, 'grad_scale': 0.2, 'resume_checkpoint': 'models/jiuniu_0267000.pth', 'sd_keys_path': 'models/stable_diffusion_image_key_temporal_attention_x1.json'}, 'viz_interval': 1000, 'resume_checkpoint': '', 'visual_train': {'type': 'VisualTrainTextImageToVideo'}, 'visual_inference': {'type': 'VisualGeneratedVideos'}, 'inference_list_path': '', 'log_interval': 100, 'log_dir': 'results\\Animate_X_infer', 'seed': 13, 'negative_prompt': 'Distorted, discontinuous, Ugly, blurry, low resolution, motionless, static, disfigured, disconnected limbs, Ugly faces, incomplete arms', 'max_frames': 132, 'round': 5, 'test_list_path': [[2, 'data/images/1.jpg', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/4.png', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/3.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 13], [2, 'data/images/10.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 14], [2, 'data/images/zhu.png', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [2, 'data/images/5.jpeg', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [1, 'data/images/2.jpeg', 'data/saved_pose/dance_3_right', 'data/saved_frames/dance_3_right', 'data/saved_pkl/dance_3_right.pkl', 13], [4, 'data/images/7.jpeg', 'data/saved_pose/ubc', 'data/saved_frames/ubc', 'data/saved_pkl/ubc.pkl', 14]], 'test_model': 'checkpoints/animate-x_ckpt.pth', 'partial_keys': [['image', 'local_image', 'dwpose', 'pose_embeddings']], 'TASK_TYPE': 'inference_animate_x_entrance', 'batch_size': 1, 'latent_random_ref': True, 'scale': 8, 'use_fps_condition': False, 'video_compositions': ['image', 'local_image', 'dwpose', 'randomref', 'randomref_pose', 'pose_embedding'], 'use_DiffusionDPM': False, 'CPU_CLIP_VAE': True, 'cfg_file': 'configs/Animate_X_infer.yaml', 'init_method': 'tcp://localhost:9999', 'debug': False, 'opts': [], 'pmi_rank': 0, 'pmi_world_size': 1, 'gpus_per_machine': 1, 'world_size': 1, 'gpu': 0, 'rank': 0, 'log_file': 'results\\Animate_X_infer\\log_00.txt'}
[2025-03-22 00:55:16,497] INFO: Running Animate-X inference on gpu 0
[2025-03-22 00:55:16,511] INFO: Loaded ViT-H-14 model config.
[2025-03-22 00:55:21,980] INFO: Loading pretrained ViT-H-14 weights (checkpoints/open_clip_pytorch_model.bin).
[2025-03-22 00:58:50,546] INFO: {'__name__': 'Config: VideoLDM Decoder', 'mean': [0.5, 0.5, 0.5], 'std': [0.5, 0.5, 0.5], 'max_words': 1000, 'num_workers': 8, 'prefetch_factor': 2, 'resolution': [512, 768], 'vit_out_dim': 1024, 'vit_resolution': [224, 224], 'depth_clamp': 10.0, 'misc_size': 384, 'depth_std': 20.0, 'save_fps': 8, 'frame_lens': [32, 32, 32, 1], 'sample_fps': [4], 'vid_dataset': {'type': 'VideoBaseDataset', 'data_list': [], 'max_words': 1000, 'resolution': [448, 256]}, 'img_dataset': {'type': 'ImageBaseDataset', 'data_list': ['laion_400m'], 'max_words': 1000, 'resolution': [448, 256]}, 'batch_sizes': {'1': 256, '4': 4, '8': 4, '16': 4}, 'Diffusion': {'type': 'DiffusionDDIM', 'schedule': 'linear_sd', 'schedule_param': {'num_timesteps': 1000, 'init_beta': 0.00085, 'last_beta': 0.012, 'zero_terminal_snr': True}, 'mean_type': 'v', 'loss_type': 'mse', 'var_type': 'fixed_small', 'rescale_timesteps': False, 'noise_strength': 0.1, 'ddim_timesteps': 50}, 'ddim_timesteps': 30, 'use_div_loss': False, 'p_zero': 0.9, 'guide_scale': 2.5, 'vit_mean': [0.48145466, 0.4578275, 0.40821073], 'vit_std': [0.26862954, 0.26130258, 0.27577711], 'sketch_mean': [0.485, 0.456, 0.406], 'sketch_std': [0.229, 0.224, 0.225], 'hist_sigma': 10.0, 'scale_factor': 0.18215, 'use_checkpoint': True, 'use_sharded_ddp': False, 'use_fsdp': False, 'use_fp16': True, 'temporal_attention': True, 'UNet': {'type': 'UNetSD_Animate_X', 'in_dim': 4, 'dim': 320, 'y_dim': 1024, 'context_dim': 1024, 'out_dim': 4, 'dim_mult': [1, 2, 4, 4], 'num_heads': 8, 'head_dim': 64, 'num_res_blocks': 2, 'attn_scales': [1.0, 0.5, 0.25], 'dropout': 0.1, 'temporal_attention': True, 'temporal_attn_times': 1, 'use_checkpoint': True, 'use_fps_condition': False, 'use_sim_mask': False, 'config': 'None', 'num': 0, 'no_hand': True, 'num_tokens': 4}, 'guidances': [], 'auto_encoder': {'type': 'AutoencoderKL', 'ddconfig': {'double_z': True, 'z_channels': 4, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 4, 4], 'num_res_blocks': 2, 'attn_resolutions': [], 'dropout': 0.0, 'video_kernel_size': [3, 1, 1]}, 'embed_dim': 4, 'pretrained': 'checkpoints/v2-1_512-ema-pruned.ckpt'}, 'embedder': {'type': 'FrozenOpenCLIPTextVisualEmbedder', 'layer': 'penultimate', 'pretrained': 'checkpoints/open_clip_pytorch_model.bin'}, 'ema_decay': 0.9999, 'num_steps': 600000, 'lr': 5e-05, 'weight_decay': 0.0, 'betas': (0.9, 0.999), 'eps': 1e-08, 'chunk_size': 2, 'decoder_bs': 2, 'alpha': 0.7, 'save_ckp_interval': 1000, 'warmup_steps': 10, 'decay_mode': 'cosine', 'use_ema': False, 'load_from': None, 'Pretrain': {'type': 'pretrain_specific_strategies', 'fix_weight': False, 'grad_scale': 0.2, 'resume_checkpoint': 'models/jiuniu_0267000.pth', 'sd_keys_path': 'models/stable_diffusion_image_key_temporal_attention_x1.json'}, 'viz_interval': 1000, 'resume_checkpoint': '', 'visual_train': {'type': 'VisualTrainTextImageToVideo'}, 'visual_inference': {'type': 'VisualGeneratedVideos'}, 'inference_list_path': '', 'log_interval': 100, 'log_dir': 'results\\Animate_X_infer', 'seed': 13, 'negative_prompt': 'Distorted, discontinuous, Ugly, blurry, low resolution, motionless, static, disfigured, disconnected limbs, Ugly faces, incomplete arms', 'max_frames': 132, 'round': 5, 'test_list_path': [[2, 'data/images/1.jpg', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/4.png', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/3.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 13], [2, 'data/images/10.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 14], [2, 'data/images/zhu.png', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [2, 'data/images/5.jpeg', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [1, 'data/images/2.jpeg', 'data/saved_pose/dance_3_right', 'data/saved_frames/dance_3_right', 'data/saved_pkl/dance_3_right.pkl', 13], [4, 'data/images/7.jpeg', 'data/saved_pose/ubc', 'data/saved_frames/ubc', 'data/saved_pkl/ubc.pkl', 14]], 'test_model': 'checkpoints/animate-x_ckpt.pth', 'partial_keys': [['image', 'local_image', 'dwpose', 'pose_embeddings']], 'TASK_TYPE': 'inference_animate_x_entrance', 'batch_size': 1, 'latent_random_ref': True, 'scale': 8, 'use_fps_condition': False, 'video_compositions': ['image', 'local_image', 'dwpose', 'randomref', 'randomref_pose', 'pose_embedding'], 'use_DiffusionDPM': False, 'CPU_CLIP_VAE': True, 'cfg_file': 'configs/Animate_X_infer.yaml', 'init_method': 'tcp://localhost:9999', 'debug': False, 'opts': [], 'pmi_rank': 0, 'pmi_world_size': 1, 'gpus_per_machine': 1, 'world_size': 1, 'gpu': 0, 'rank': 0, 'log_file': 'results\\Animate_X_infer\\log_00.txt'}
[2025-03-22 00:58:50,547] INFO: Running Animate-X inference on gpu 0
[2025-03-22 00:58:50,555] INFO: Loaded ViT-H-14 model config.
[2025-03-22 00:58:55,813] INFO: Loading pretrained ViT-H-14 weights (checkpoints/open_clip_pytorch_model.bin).
[2025-03-22 01:05:16,554] INFO: {'__name__': 'Config: VideoLDM Decoder', 'mean': [0.5, 0.5, 0.5], 'std': [0.5, 0.5, 0.5], 'max_words': 1000, 'num_workers': 8, 'prefetch_factor': 2, 'resolution': [512, 768], 'vit_out_dim': 1024, 'vit_resolution': [224, 224], 'depth_clamp': 10.0, 'misc_size': 384, 'depth_std': 20.0, 'save_fps': 8, 'frame_lens': [32, 32, 32, 1], 'sample_fps': [4], 'vid_dataset': {'type': 'VideoBaseDataset', 'data_list': [], 'max_words': 1000, 'resolution': [448, 256]}, 'img_dataset': {'type': 'ImageBaseDataset', 'data_list': ['laion_400m'], 'max_words': 1000, 'resolution': [448, 256]}, 'batch_sizes': {'1': 256, '4': 4, '8': 4, '16': 4}, 'Diffusion': {'type': 'DiffusionDDIM', 'schedule': 'linear_sd', 'schedule_param': {'num_timesteps': 1000, 'init_beta': 0.00085, 'last_beta': 0.012, 'zero_terminal_snr': True}, 'mean_type': 'v', 'loss_type': 'mse', 'var_type': 'fixed_small', 'rescale_timesteps': False, 'noise_strength': 0.1, 'ddim_timesteps': 50}, 'ddim_timesteps': 30, 'use_div_loss': False, 'p_zero': 0.9, 'guide_scale': 2.5, 'vit_mean': [0.48145466, 0.4578275, 0.40821073], 'vit_std': [0.26862954, 0.26130258, 0.27577711], 'sketch_mean': [0.485, 0.456, 0.406], 'sketch_std': [0.229, 0.224, 0.225], 'hist_sigma': 10.0, 'scale_factor': 0.18215, 'use_checkpoint': True, 'use_sharded_ddp': False, 'use_fsdp': False, 'use_fp16': True, 'temporal_attention': True, 'UNet': {'type': 'UNetSD_Animate_X', 'in_dim': 4, 'dim': 320, 'y_dim': 1024, 'context_dim': 1024, 'out_dim': 4, 'dim_mult': [1, 2, 4, 4], 'num_heads': 8, 'head_dim': 64, 'num_res_blocks': 2, 'attn_scales': [1.0, 0.5, 0.25], 'dropout': 0.1, 'temporal_attention': True, 'temporal_attn_times': 1, 'use_checkpoint': True, 'use_fps_condition': False, 'use_sim_mask': False, 'config': 'None', 'num': 0, 'no_hand': True, 'num_tokens': 4}, 'guidances': [], 'auto_encoder': {'type': 'AutoencoderKL', 'ddconfig': {'double_z': True, 'z_channels': 4, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 4, 4], 'num_res_blocks': 2, 'attn_resolutions': [], 'dropout': 0.0, 'video_kernel_size': [3, 1, 1]}, 'embed_dim': 4, 'pretrained': 'checkpoints/v2-1_512-ema-pruned.ckpt'}, 'embedder': {'type': 'FrozenOpenCLIPTextVisualEmbedder', 'layer': 'penultimate', 'pretrained': 'checkpoints/open_clip_pytorch_model.bin'}, 'ema_decay': 0.9999, 'num_steps': 600000, 'lr': 5e-05, 'weight_decay': 0.0, 'betas': (0.9, 0.999), 'eps': 1e-08, 'chunk_size': 2, 'decoder_bs': 2, 'alpha': 0.7, 'save_ckp_interval': 1000, 'warmup_steps': 10, 'decay_mode': 'cosine', 'use_ema': False, 'load_from': None, 'Pretrain': {'type': 'pretrain_specific_strategies', 'fix_weight': False, 'grad_scale': 0.2, 'resume_checkpoint': 'models/jiuniu_0267000.pth', 'sd_keys_path': 'models/stable_diffusion_image_key_temporal_attention_x1.json'}, 'viz_interval': 1000, 'resume_checkpoint': '', 'visual_train': {'type': 'VisualTrainTextImageToVideo'}, 'visual_inference': {'type': 'VisualGeneratedVideos'}, 'inference_list_path': '', 'log_interval': 100, 'log_dir': 'results\\Animate_X_infer', 'seed': 13, 'negative_prompt': 'Distorted, discontinuous, Ugly, blurry, low resolution, motionless, static, disfigured, disconnected limbs, Ugly faces, incomplete arms', 'max_frames': 132, 'round': 5, 'test_list_path': [[2, 'data/images/1.jpg', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/4.png', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/3.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 13], [2, 'data/images/10.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 14], [2, 'data/images/zhu.png', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [2, 'data/images/5.jpeg', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [1, 'data/images/2.jpeg', 'data/saved_pose/dance_3_right', 'data/saved_frames/dance_3_right', 'data/saved_pkl/dance_3_right.pkl', 13], [4, 'data/images/7.jpeg', 'data/saved_pose/ubc', 'data/saved_frames/ubc', 'data/saved_pkl/ubc.pkl', 14]], 'test_model': 'checkpoints/animate-x_ckpt.pth', 'partial_keys': [['image', 'local_image', 'dwpose', 'pose_embeddings']], 'TASK_TYPE': 'inference_animate_x_entrance', 'batch_size': 1, 'latent_random_ref': True, 'scale': 8, 'use_fps_condition': False, 'video_compositions': ['image', 'local_image', 'dwpose', 'randomref', 'randomref_pose', 'pose_embedding'], 'use_DiffusionDPM': False, 'CPU_CLIP_VAE': True, 'cfg_file': 'configs/Animate_X_infer.yaml', 'init_method': 'tcp://localhost:9999', 'debug': False, 'opts': [], 'pmi_rank': 0, 'pmi_world_size': 1, 'gpus_per_machine': 1, 'world_size': 1, 'gpu': 0, 'rank': 0, 'log_file': 'results\\Animate_X_infer\\log_00.txt'}
[2025-03-22 01:05:16,555] INFO: Running Animate-X inference on gpu 0
[2025-03-22 01:05:16,566] INFO: Loaded ViT-H-14 model config.
[2025-03-22 01:05:22,001] INFO: Loading pretrained ViT-H-14 weights (checkpoints/open_clip_pytorch_model.bin).
[2025-03-22 01:12:22,242] INFO: {'__name__': 'Config: VideoLDM Decoder', 'mean': [0.5, 0.5, 0.5], 'std': [0.5, 0.5, 0.5], 'max_words': 1000, 'num_workers': 8, 'prefetch_factor': 2, 'resolution': [512, 768], 'vit_out_dim': 1024, 'vit_resolution': [224, 224], 'depth_clamp': 10.0, 'misc_size': 384, 'depth_std': 20.0, 'save_fps': 8, 'frame_lens': [32, 32, 32, 1], 'sample_fps': [4], 'vid_dataset': {'type': 'VideoBaseDataset', 'data_list': [], 'max_words': 1000, 'resolution': [448, 256]}, 'img_dataset': {'type': 'ImageBaseDataset', 'data_list': ['laion_400m'], 'max_words': 1000, 'resolution': [448, 256]}, 'batch_sizes': {'1': 256, '4': 4, '8': 4, '16': 4}, 'Diffusion': {'type': 'DiffusionDDIM', 'schedule': 'linear_sd', 'schedule_param': {'num_timesteps': 1000, 'init_beta': 0.00085, 'last_beta': 0.012, 'zero_terminal_snr': True}, 'mean_type': 'v', 'loss_type': 'mse', 'var_type': 'fixed_small', 'rescale_timesteps': False, 'noise_strength': 0.1, 'ddim_timesteps': 50}, 'ddim_timesteps': 30, 'use_div_loss': False, 'p_zero': 0.9, 'guide_scale': 2.5, 'vit_mean': [0.48145466, 0.4578275, 0.40821073], 'vit_std': [0.26862954, 0.26130258, 0.27577711], 'sketch_mean': [0.485, 0.456, 0.406], 'sketch_std': [0.229, 0.224, 0.225], 'hist_sigma': 10.0, 'scale_factor': 0.18215, 'use_checkpoint': True, 'use_sharded_ddp': False, 'use_fsdp': False, 'use_fp16': True, 'temporal_attention': True, 'UNet': {'type': 'UNetSD_Animate_X', 'in_dim': 4, 'dim': 320, 'y_dim': 1024, 'context_dim': 1024, 'out_dim': 4, 'dim_mult': [1, 2, 4, 4], 'num_heads': 8, 'head_dim': 64, 'num_res_blocks': 2, 'attn_scales': [1.0, 0.5, 0.25], 'dropout': 0.1, 'temporal_attention': True, 'temporal_attn_times': 1, 'use_checkpoint': True, 'use_fps_condition': False, 'use_sim_mask': False, 'config': 'None', 'num': 0, 'no_hand': True, 'num_tokens': 4}, 'guidances': [], 'auto_encoder': {'type': 'AutoencoderKL', 'ddconfig': {'double_z': True, 'z_channels': 4, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 4, 4], 'num_res_blocks': 2, 'attn_resolutions': [], 'dropout': 0.0, 'video_kernel_size': [3, 1, 1]}, 'embed_dim': 4, 'pretrained': 'checkpoints/v2-1_512-ema-pruned.ckpt'}, 'embedder': {'type': 'FrozenOpenCLIPTextVisualEmbedder', 'layer': 'penultimate', 'pretrained': 'checkpoints/open_clip_pytorch_model.bin'}, 'ema_decay': 0.9999, 'num_steps': 600000, 'lr': 5e-05, 'weight_decay': 0.0, 'betas': (0.9, 0.999), 'eps': 1e-08, 'chunk_size': 2, 'decoder_bs': 2, 'alpha': 0.7, 'save_ckp_interval': 1000, 'warmup_steps': 10, 'decay_mode': 'cosine', 'use_ema': False, 'load_from': None, 'Pretrain': {'type': 'pretrain_specific_strategies', 'fix_weight': False, 'grad_scale': 0.2, 'resume_checkpoint': 'models/jiuniu_0267000.pth', 'sd_keys_path': 'models/stable_diffusion_image_key_temporal_attention_x1.json'}, 'viz_interval': 1000, 'resume_checkpoint': '', 'visual_train': {'type': 'VisualTrainTextImageToVideo'}, 'visual_inference': {'type': 'VisualGeneratedVideos'}, 'inference_list_path': '', 'log_interval': 100, 'log_dir': 'results\\Animate_X_infer', 'seed': 13, 'negative_prompt': 'Distorted, discontinuous, Ugly, blurry, low resolution, motionless, static, disfigured, disconnected limbs, Ugly faces, incomplete arms', 'max_frames': 132, 'round': 5, 'test_list_path': [[2, 'data/images/1.jpg', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/4.png', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/3.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 13], [2, 'data/images/10.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 14], [2, 'data/images/zhu.png', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [2, 'data/images/5.jpeg', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [1, 'data/images/2.jpeg', 'data/saved_pose/dance_3_right', 'data/saved_frames/dance_3_right', 'data/saved_pkl/dance_3_right.pkl', 13], [4, 'data/images/7.jpeg', 'data/saved_pose/ubc', 'data/saved_frames/ubc', 'data/saved_pkl/ubc.pkl', 14]], 'test_model': 'checkpoints/animate-x_ckpt.pth', 'partial_keys': [['image', 'local_image', 'dwpose', 'pose_embeddings']], 'TASK_TYPE': 'inference_animate_x_entrance', 'batch_size': 1, 'latent_random_ref': True, 'scale': 8, 'use_fps_condition': False, 'video_compositions': ['image', 'local_image', 'dwpose', 'randomref', 'randomref_pose', 'pose_embedding'], 'use_DiffusionDPM': False, 'CPU_CLIP_VAE': True, 'cfg_file': 'configs/Animate_X_infer.yaml', 'init_method': 'tcp://localhost:9999', 'debug': False, 'opts': [], 'pmi_rank': 0, 'pmi_world_size': 1, 'gpus_per_machine': 1, 'world_size': 1, 'gpu': 0, 'rank': 0, 'log_file': 'results\\Animate_X_infer\\log_00.txt'}
[2025-03-22 01:12:22,243] INFO: Running Animate-X inference on gpu 0
[2025-03-22 01:12:22,265] INFO: Loaded ViT-H-14 model config.
[2025-03-22 01:12:27,572] INFO: Loading pretrained ViT-H-14 weights (checkpoints/open_clip_pytorch_model.bin).
[2025-03-22 01:20:04,558] INFO: {'__name__': 'Config: VideoLDM Decoder', 'mean': [0.5, 0.5, 0.5], 'std': [0.5, 0.5, 0.5], 'max_words': 1000, 'num_workers': 8, 'prefetch_factor': 2, 'resolution': [512, 768], 'vit_out_dim': 1024, 'vit_resolution': [224, 224], 'depth_clamp': 10.0, 'misc_size': 384, 'depth_std': 20.0, 'save_fps': 8, 'frame_lens': [32, 32, 32, 1], 'sample_fps': [4], 'vid_dataset': {'type': 'VideoBaseDataset', 'data_list': [], 'max_words': 1000, 'resolution': [448, 256]}, 'img_dataset': {'type': 'ImageBaseDataset', 'data_list': ['laion_400m'], 'max_words': 1000, 'resolution': [448, 256]}, 'batch_sizes': {'1': 256, '4': 4, '8': 4, '16': 4}, 'Diffusion': {'type': 'DiffusionDDIM', 'schedule': 'linear_sd', 'schedule_param': {'num_timesteps': 1000, 'init_beta': 0.00085, 'last_beta': 0.012, 'zero_terminal_snr': True}, 'mean_type': 'v', 'loss_type': 'mse', 'var_type': 'fixed_small', 'rescale_timesteps': False, 'noise_strength': 0.1, 'ddim_timesteps': 50}, 'ddim_timesteps': 30, 'use_div_loss': False, 'p_zero': 0.9, 'guide_scale': 2.5, 'vit_mean': [0.48145466, 0.4578275, 0.40821073], 'vit_std': [0.26862954, 0.26130258, 0.27577711], 'sketch_mean': [0.485, 0.456, 0.406], 'sketch_std': [0.229, 0.224, 0.225], 'hist_sigma': 10.0, 'scale_factor': 0.18215, 'use_checkpoint': True, 'use_sharded_ddp': False, 'use_fsdp': False, 'use_fp16': True, 'temporal_attention': True, 'UNet': {'type': 'UNetSD_Animate_X', 'in_dim': 4, 'dim': 320, 'y_dim': 1024, 'context_dim': 1024, 'out_dim': 4, 'dim_mult': [1, 2, 4, 4], 'num_heads': 8, 'head_dim': 64, 'num_res_blocks': 2, 'attn_scales': [1.0, 0.5, 0.25], 'dropout': 0.1, 'temporal_attention': True, 'temporal_attn_times': 1, 'use_checkpoint': True, 'use_fps_condition': False, 'use_sim_mask': False, 'config': 'None', 'num': 0, 'no_hand': True, 'num_tokens': 4}, 'guidances': [], 'auto_encoder': {'type': 'AutoencoderKL', 'ddconfig': {'double_z': True, 'z_channels': 4, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 4, 4], 'num_res_blocks': 2, 'attn_resolutions': [], 'dropout': 0.0, 'video_kernel_size': [3, 1, 1]}, 'embed_dim': 4, 'pretrained': 'checkpoints/v2-1_512-ema-pruned.ckpt'}, 'embedder': {'type': 'FrozenOpenCLIPTextVisualEmbedder', 'layer': 'penultimate', 'pretrained': 'checkpoints/open_clip_pytorch_model.bin'}, 'ema_decay': 0.9999, 'num_steps': 600000, 'lr': 5e-05, 'weight_decay': 0.0, 'betas': (0.9, 0.999), 'eps': 1e-08, 'chunk_size': 2, 'decoder_bs': 2, 'alpha': 0.7, 'save_ckp_interval': 1000, 'warmup_steps': 10, 'decay_mode': 'cosine', 'use_ema': False, 'load_from': None, 'Pretrain': {'type': 'pretrain_specific_strategies', 'fix_weight': False, 'grad_scale': 0.2, 'resume_checkpoint': 'models/jiuniu_0267000.pth', 'sd_keys_path': 'models/stable_diffusion_image_key_temporal_attention_x1.json'}, 'viz_interval': 1000, 'resume_checkpoint': '', 'visual_train': {'type': 'VisualTrainTextImageToVideo'}, 'visual_inference': {'type': 'VisualGeneratedVideos'}, 'inference_list_path': '', 'log_interval': 100, 'log_dir': 'results\\Animate_X_infer', 'seed': 13, 'negative_prompt': 'Distorted, discontinuous, Ugly, blurry, low resolution, motionless, static, disfigured, disconnected limbs, Ugly faces, incomplete arms', 'max_frames': 132, 'round': 5, 'test_list_path': [[2, 'data/images/1.jpg', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/4.png', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/3.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 13], [2, 'data/images/10.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 14], [2, 'data/images/zhu.png', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [2, 'data/images/5.jpeg', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [1, 'data/images/2.jpeg', 'data/saved_pose/dance_3_right', 'data/saved_frames/dance_3_right', 'data/saved_pkl/dance_3_right.pkl', 13], [4, 'data/images/7.jpeg', 'data/saved_pose/ubc', 'data/saved_frames/ubc', 'data/saved_pkl/ubc.pkl', 14]], 'test_model': 'checkpoints/animate-x_ckpt.pth', 'partial_keys': [['image', 'local_image', 'dwpose', 'pose_embeddings']], 'TASK_TYPE': 'inference_animate_x_entrance', 'batch_size': 1, 'latent_random_ref': True, 'scale': 8, 'use_fps_condition': False, 'video_compositions': ['image', 'local_image', 'dwpose', 'randomref', 'randomref_pose', 'pose_embedding'], 'use_DiffusionDPM': False, 'CPU_CLIP_VAE': True, 'cfg_file': 'configs/Animate_X_infer.yaml', 'init_method': 'tcp://localhost:9999', 'debug': False, 'opts': [], 'pmi_rank': 0, 'pmi_world_size': 1, 'gpus_per_machine': 1, 'world_size': 1, 'gpu': 0, 'rank': 0, 'log_file': 'results\\Animate_X_infer\\log_00.txt'}
[2025-03-22 01:20:04,559] INFO: Running Animate-X inference on gpu 0
[2025-03-22 01:20:04,573] INFO: Loaded ViT-H-14 model config.
[2025-03-22 01:20:14,387] INFO: Loading pretrained ViT-H-14 weights (checkpoints/open_clip_pytorch_model.bin).
[2025-03-22 01:20:53,670] INFO: Restored from checkpoints/v2-1_512-ema-pruned.ckpt
[2025-03-22 02:14:09,732] INFO: {'__name__': 'Config: VideoLDM Decoder', 'mean': [0.5, 0.5, 0.5], 'std': [0.5, 0.5, 0.5], 'max_words': 1000, 'num_workers': 8, 'prefetch_factor': 2, 'resolution': [512, 768], 'vit_out_dim': 1024, 'vit_resolution': [224, 224], 'depth_clamp': 10.0, 'misc_size': 384, 'depth_std': 20.0, 'save_fps': 8, 'frame_lens': [32, 32, 32, 1], 'sample_fps': [4], 'vid_dataset': {'type': 'VideoBaseDataset', 'data_list': [], 'max_words': 1000, 'resolution': [448, 256]}, 'img_dataset': {'type': 'ImageBaseDataset', 'data_list': ['laion_400m'], 'max_words': 1000, 'resolution': [448, 256]}, 'batch_sizes': {'1': 256, '4': 4, '8': 4, '16': 4}, 'Diffusion': {'type': 'DiffusionDDIM', 'schedule': 'linear_sd', 'schedule_param': {'num_timesteps': 1000, 'init_beta': 0.00085, 'last_beta': 0.012, 'zero_terminal_snr': True}, 'mean_type': 'v', 'loss_type': 'mse', 'var_type': 'fixed_small', 'rescale_timesteps': False, 'noise_strength': 0.1, 'ddim_timesteps': 50}, 'ddim_timesteps': 30, 'use_div_loss': False, 'p_zero': 0.9, 'guide_scale': 2.5, 'vit_mean': [0.48145466, 0.4578275, 0.40821073], 'vit_std': [0.26862954, 0.26130258, 0.27577711], 'sketch_mean': [0.485, 0.456, 0.406], 'sketch_std': [0.229, 0.224, 0.225], 'hist_sigma': 10.0, 'scale_factor': 0.18215, 'use_checkpoint': True, 'use_sharded_ddp': False, 'use_fsdp': False, 'use_fp16': True, 'temporal_attention': True, 'UNet': {'type': 'UNetSD_Animate_X', 'in_dim': 4, 'dim': 320, 'y_dim': 1024, 'context_dim': 1024, 'out_dim': 4, 'dim_mult': [1, 2, 4, 4], 'num_heads': 8, 'head_dim': 64, 'num_res_blocks': 2, 'attn_scales': [1.0, 0.5, 0.25], 'dropout': 0.1, 'temporal_attention': True, 'temporal_attn_times': 1, 'use_checkpoint': True, 'use_fps_condition': False, 'use_sim_mask': False, 'config': 'None', 'num': 0, 'no_hand': True, 'num_tokens': 4}, 'guidances': [], 'auto_encoder': {'type': 'AutoencoderKL', 'ddconfig': {'double_z': True, 'z_channels': 4, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 4, 4], 'num_res_blocks': 2, 'attn_resolutions': [], 'dropout': 0.0, 'video_kernel_size': [3, 1, 1]}, 'embed_dim': 4, 'pretrained': 'checkpoints/v2-1_512-ema-pruned.ckpt'}, 'embedder': {'type': 'FrozenOpenCLIPTextVisualEmbedder', 'layer': 'penultimate', 'pretrained': 'checkpoints/open_clip_pytorch_model.bin'}, 'ema_decay': 0.9999, 'num_steps': 600000, 'lr': 5e-05, 'weight_decay': 0.0, 'betas': (0.9, 0.999), 'eps': 1e-08, 'chunk_size': 2, 'decoder_bs': 2, 'alpha': 0.7, 'save_ckp_interval': 1000, 'warmup_steps': 10, 'decay_mode': 'cosine', 'use_ema': False, 'load_from': None, 'Pretrain': {'type': 'pretrain_specific_strategies', 'fix_weight': False, 'grad_scale': 0.2, 'resume_checkpoint': 'models/jiuniu_0267000.pth', 'sd_keys_path': 'models/stable_diffusion_image_key_temporal_attention_x1.json'}, 'viz_interval': 1000, 'resume_checkpoint': '', 'visual_train': {'type': 'VisualTrainTextImageToVideo'}, 'visual_inference': {'type': 'VisualGeneratedVideos'}, 'inference_list_path': '', 'log_interval': 100, 'log_dir': 'results\\Animate_X_infer', 'seed': 13, 'negative_prompt': 'Distorted, discontinuous, Ugly, blurry, low resolution, motionless, static, disfigured, disconnected limbs, Ugly faces, incomplete arms', 'max_frames': 132, 'round': 5, 'test_list_path': [[2, 'data/images/1.jpg', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/4.png', 'data/saved_pose/dance_1', 'data/saved_frames/dance_1', 'data/saved_pkl/dance_1.pkl', 14], [2, 'data/images/3.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 13], [2, 'data/images/10.jpeg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 14], [2, 'data/images/zhu.png', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [2, 'data/images/5.jpeg', 'data/saved_pose/dance_3', 'data/saved_frames/dance_3', 'data/saved_pkl/dance_3.pkl', 14], [1, 'data/images/2.jpeg', 'data/saved_pose/dance_3_right', 'data/saved_frames/dance_3_right', 'data/saved_pkl/dance_3_right.pkl', 13], [4, 'data/images/7.jpeg', 'data/saved_pose/ubc', 'data/saved_frames/ubc', 'data/saved_pkl/ubc.pkl', 14]], 'test_model': 'checkpoints/animate-x_ckpt.pth', 'partial_keys': [['image', 'local_image', 'dwpose', 'pose_embeddings']], 'TASK_TYPE': 'inference_animate_x_entrance', 'batch_size': 1, 'latent_random_ref': True, 'scale': 8, 'use_fps_condition': False, 'video_compositions': ['image', 'local_image', 'dwpose', 'randomref', 'randomref_pose', 'pose_embedding'], 'use_DiffusionDPM': False, 'CPU_CLIP_VAE': True, 'cfg_file': 'configs/Animate_X_infer.yaml', 'init_method': 'tcp://localhost:9999', 'debug': False, 'opts': [], 'pmi_rank': 0, 'pmi_world_size': 1, 'gpus_per_machine': 1, 'world_size': 1, 'gpu': 0, 'rank': 0, 'log_file': 'results\\Animate_X_infer\\log_00.txt'}
[2025-03-22 02:14:09,733] INFO: Running Animate-X inference on gpu 0
[2025-03-22 02:14:09,752] INFO: Loaded ViT-H-14 model config.
[2025-03-22 02:14:14,559] INFO: Loading pretrained ViT-H-14 weights (checkpoints/open_clip_pytorch_model.bin).
[2025-03-22 02:14:52,586] INFO: Restored from checkpoints/v2-1_512-ema-pruned.ckpt
[2025-03-22 02:15:31,895] INFO: Load model from checkpoints/animate-x_ckpt.pth with status <All keys matched successfully>
[2025-03-22 02:15:36,219] INFO: There are 8 videos. with 5 times
[2025-03-22 02:15:36,220] INFO: [0]/[40] Begin to sample data/images/1.jpg, pose sequence from data/saved_pose/dance_1 init seed 14 ...
[2025-03-22 02:27:50,948] INFO: {'__name__': 'Config: VideoLDM Decoder', 'mean': [0.5, 0.5, 0.5], 'std': [0.5, 0.5, 0.5], 'max_words': 1000, 'num_workers': 8, 'prefetch_factor': 2, 'resolution': [512, 768], 'vit_out_dim': 1024, 'vit_resolution': [224, 224], 'depth_clamp': 10.0, 'misc_size': 384, 'depth_std': 20.0, 'save_fps': 8, 'frame_lens': [32, 32, 32, 1], 'sample_fps': [4], 'vid_dataset': {'type': 'VideoBaseDataset', 'data_list': [], 'max_words': 1000, 'resolution': [448, 256]}, 'img_dataset': {'type': 'ImageBaseDataset', 'data_list': ['laion_400m'], 'max_words': 1000, 'resolution': [448, 256]}, 'batch_sizes': {'1': 256, '4': 4, '8': 4, '16': 4}, 'Diffusion': {'type': 'DiffusionDDIM', 'schedule': 'linear_sd', 'schedule_param': {'num_timesteps': 1000, 'init_beta': 0.00085, 'last_beta': 0.012, 'zero_terminal_snr': True}, 'mean_type': 'v', 'loss_type': 'mse', 'var_type': 'fixed_small', 'rescale_timesteps': False, 'noise_strength': 0.1, 'ddim_timesteps': 50}, 'ddim_timesteps': 30, 'use_div_loss': False, 'p_zero': 0.9, 'guide_scale': 2.5, 'vit_mean': [0.48145466, 0.4578275, 0.40821073], 'vit_std': [0.26862954, 0.26130258, 0.27577711], 'sketch_mean': [0.485, 0.456, 0.406], 'sketch_std': [0.229, 0.224, 0.225], 'hist_sigma': 10.0, 'scale_factor': 0.18215, 'use_checkpoint': True, 'use_sharded_ddp': False, 'use_fsdp': False, 'use_fp16': True, 'temporal_attention': True, 'UNet': {'type': 'UNetSD_Animate_X', 'in_dim': 4, 'dim': 320, 'y_dim': 1024, 'context_dim': 1024, 'out_dim': 4, 'dim_mult': [1, 2, 4, 4], 'num_heads': 8, 'head_dim': 64, 'num_res_blocks': 2, 'attn_scales': [1.0, 0.5, 0.25], 'dropout': 0.1, 'temporal_attention': True, 'temporal_attn_times': 1, 'use_checkpoint': True, 'use_fps_condition': False, 'use_sim_mask': False, 'config': 'None', 'num': 0, 'no_hand': True, 'num_tokens': 4}, 'guidances': [], 'auto_encoder': {'type': 'AutoencoderKL', 'ddconfig': {'double_z': True, 'z_channels': 4, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 4, 4], 'num_res_blocks': 2, 'attn_resolutions': [], 'dropout': 0.0, 'video_kernel_size': [3, 1, 1]}, 'embed_dim': 4, 'pretrained': 'checkpoints/v2-1_512-ema-pruned.ckpt'}, 'embedder': {'type': 'FrozenOpenCLIPTextVisualEmbedder', 'layer': 'penultimate', 'pretrained': 'checkpoints/open_clip_pytorch_model.bin'}, 'ema_decay': 0.9999, 'num_steps': 600000, 'lr': 5e-05, 'weight_decay': 0.0, 'betas': (0.9, 0.999), 'eps': 1e-08, 'chunk_size': 2, 'decoder_bs': 2, 'alpha': 0.7, 'save_ckp_interval': 1000, 'warmup_steps': 10, 'decay_mode': 'cosine', 'use_ema': False, 'load_from': None, 'Pretrain': {'type': 'pretrain_specific_strategies', 'fix_weight': False, 'grad_scale': 0.2, 'resume_checkpoint': 'models/jiuniu_0267000.pth', 'sd_keys_path': 'models/stable_diffusion_image_key_temporal_attention_x1.json'}, 'viz_interval': 1000, 'resume_checkpoint': '', 'visual_train': {'type': 'VisualTrainTextImageToVideo'}, 'visual_inference': {'type': 'VisualGeneratedVideos'}, 'inference_list_path': '', 'log_interval': 100, 'log_dir': 'results\\Animate_X_infer', 'seed': 13, 'negative_prompt': 'Distorted, discontinuous, Ugly, blurry, low resolution, motionless, static, disfigured, disconnected limbs, Ugly faces, incomplete arms', 'max_frames': 320, 'round': 5, 'test_list_path': [[2, 'data/images/1.jpg', 'data/saved_pose/dance_2', 'data/saved_frames/dance_2', 'data/saved_pkl/dance_2.pkl', 14]], 'test_model': 'checkpoints/animate-x_ckpt.pth', 'partial_keys': [['image', 'local_image', 'dwpose', 'pose_embeddings']], 'TASK_TYPE': 'inference_animate_x_entrance', 'batch_size': 1, 'latent_random_ref': True, 'scale': 8, 'use_fps_condition': False, 'video_compositions': ['image', 'local_image', 'dwpose', 'randomref', 'randomref_pose', 'pose_embedding'], 'use_DiffusionDPM': False, 'CPU_CLIP_VAE': True, 'cfg_file': 'configs/Animate_X_infer.yaml', 'init_method': 'tcp://localhost:9999', 'debug': False, 'opts': [], 'pmi_rank': 0, 'pmi_world_size': 1, 'gpus_per_machine': 1, 'world_size': 1, 'gpu': 0, 'rank': 0, 'log_file': 'results\\Animate_X_infer\\log_00.txt'}
[2025-03-22 02:27:50,948] INFO: Running Animate-X inference on gpu 0
[2025-03-22 02:27:50,960] INFO: Loaded ViT-H-14 model config.
[2025-03-22 02:27:56,464] INFO: Loading pretrained ViT-H-14 weights (checkpoints/open_clip_pytorch_model.bin).
[2025-03-22 02:28:33,233] INFO: Restored from checkpoints/v2-1_512-ema-pruned.ckpt
[2025-03-22 02:29:11,379] INFO: Load model from checkpoints/animate-x_ckpt.pth with status <All keys matched successfully>
[2025-03-22 02:29:33,482] INFO: There are 1 videos. with 5 times
[2025-03-22 02:29:33,504] INFO: [0]/[5] Begin to sample data/images/1.jpg, pose sequence from data/saved_pose/dance_2 init seed 14 ...
